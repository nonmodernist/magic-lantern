<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magic Lantern - Search Results</title>
    <link rel="stylesheet" href="../../shared/common.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header class="header">
        <div class="edition-info">
            Vol. 5.‚ÄîNo. 0.2.<br>
            SUMMER, 2025.
        </div>
        <h1 class="main-title">‚ú® MAGIC LANTERN ‚ú®</h1>
        <p class="subtitle">Comprehensive Search Results</p>
    </header>

    <!-- Add this right after your header in each page -->
    <nav class="main-navigation">
        <a href="../home/index.html" class="nav-item">üîç Search</a>
        <a href="../search-results/index.html" class="nav-item">üìä Results</a>
        <a href="../profile-selector/index.html" class="nav-item">‚öôÔ∏è Profiles</a>
        <a href="../about/index.html" class="nav-item">üìñ About</a>
    </nav>

    <div class="container">
        <!-- Navigation Bar -->
        <div class="navigation-bar">
            <button class="btn btn-secondary"
                onclick="window.location.href='../home/index.html'">
                ‚Üê Back to Search
            </button>
            <div class="nav-actions">
                <!-- NEW: Load Results File Button -->
                <button class="btn btn-secondary" onclick="loadResultsFile()" id="load-file-btn">
                    üìÇ Load Results File
                </button>
                <button class="btn btn-secondary" onclick="selectAll()" id="select-all-btn">
                    Select All
                </button>
                <button class="btn btn-secondary" onclick="clearAll()" id="clear-all-btn" style="display: none;">
                    Clear All
                </button>
                <button class="btn btn-primary" onclick="exportSelected()"
                    id="export-selected-btn" style="display: none;">
                    Export Selected (<span id="selected-count">0</span>)
                </button>
                <button class="btn btn-secondary" onclick="exportResults()">
                    Export JSON
                </button>
                <button class="btn btn-secondary" onclick="generateReport()">
                    Generate Report
                </button>
            </div>
        </div>

        <!-- Results Summary -->
        <div class="results-section">
            <div class="results-header">
                <h2 class="section-header">
                    <span class="section-number">üìä</span>
                    SEARCH SUMMARY
                </h2>
                <div class="results-timestamp" id="results-timestamp"></div>
            </div>

            <!-- NEW: Loaded File Info -->
            <div id="loaded-file-info" class="file-info" style="display: none; margin-bottom: 20px;">
                <p><strong>Loaded from file:</strong> <span id="loaded-filename"></span></p>
            </div>

            <div class="summary-grid">
                <div class="summary-card">
                    <div class="summary-number" id="films-count">0</div>
                    <div class="summary-label">Films Processed</div>
                </div>
                <div class="summary-card">
                    <div class="summary-number" id="sources-count">0</div>
                    <div class="summary-label">Total Sources Found</div>
                </div>
                <div class="summary-card">
                    <div class="summary-number" id="unique-count">0</div>
                    <div class="summary-label">Unique Sources</div>
                </div>
                <div class="summary-card">
                    <div class="summary-number" id="treasures-count">0</div>
                    <div class="summary-label">Treasure Finds</div>
                </div>
            </div>
        </div>

        <!-- Add after the summary grid -->
<div id="next-steps-guide" class="next-steps-section" style="display: none;">
    <div class="section-header">
        <span class="section-number">üí°</span>
        WHAT TO DO NEXT
    </div>
    
    <div class="next-steps-content">
        <div class="step-cards">
            <div class="step-card">
                <div class="step-number">1</div>
                <h4>Review & Select</h4>
                <p>Scan through your results and check the boxes next to promising sources. Look for:</p>
                <ul>
                    <li>High scores (80+)</li>
                    <li>Relevant excerpts</li>
                    <li>Variety of publications</li>
                </ul>
            </div>
            
            <div class="step-card">
                <div class="step-number">2</div>
                <h4>Export Your Finds</h4>
                <p>Click "Export Selected" to save your chosen sources, or "Export JSON" for everything.</p>
                <ul>
                    <li>Selected sources ‚Üí focused dataset</li>
                    <li>Full export ‚Üí complete archive</li>
                    <li>Both save as JSON files</li>
                </ul>
            </div>
            
            <div class="step-card">
                <div class="step-number">3</div>
                <h4>Deep Dive</h4>
                <p>Visit sources on Lantern to read full articles in context. The "View on Lantern" links take you directly there.</p>
                <ul>
                    <li>Read surrounding pages</li>
                    <li>Check publication dates</li>
                    <li>Note article placement</li>
                </ul>
            </div>
        </div>
        
        <div class="pro-tips">
            <h4>üéØ Pro Tips</h4>
            <div class="tip-grid">
                <div class="tip">
                    <strong>Score Guide:</strong> 
                    Sources scoring 80+ often contain substantial content. 
                    60-79 = good mentions. 
                    Below 60 = brief references.
                </div>
                <div class="tip">
                    <strong>Publication Patterns:</strong> 
                    Notice which publications cover your films most. 
                    This reveals editorial interests and audience demographics.
                </div>
                <div class="tip">
                    <strong>Date Clusters:</strong> 
                    Sources often cluster around release dates, 
                    but pre-release publicity and later retrospectives can be goldmines.
                </div>
                <div class="tip">
                    <strong>Strategy Success:</strong> 
                    The strategy bars show which searches worked best. 
                    Use this to refine future searches.
                </div>
            </div>
        </div>
        
        <div class="guide-actions">
            <button class="btn btn-secondary" onclick="dismissGuide()">
                Got it, thanks!
            </button>
            <label class="dont-show-again">
                <input type="checkbox" id="dont-show-guide"> 
                Don't show this again
            </label>
        </div>
    </div>
</div>

        <!-- Film Results Container -->
        <div id="film-results-container">
            <div class="loading">
                <div class="loading-spinner"></div>
                <p class="loading-text">Retrieving your research findings...</p>
            </div>
        </div>
    </div>

    <!-- Film Result Template (hidden, used by JavaScript) -->
    <template id="film-result-template">
        <div class="film-section">
            <div class="film-header">
                <div class="film-info">
                    <h3 class="film-title"></h3>
                    <p class="film-meta"></p>
                </div>
                <div class="film-stats">
                    <span class="sources-badge"></span>
                </div>
            </div>

            <div class="strategy-summary">
                <h4 class="subsection-title">Search Strategy Performance</h4>
                <div class="strategy-bars"></div>
            </div>

            <div class="source-list">
                <h4 class="subsection-title">Sources Found</h4>
                <div class="sources-container"></div>
            </div>
        </div>
    </template>

    <!-- Source Item Template -->
    <template id="source-item-template">
        <div class="source-card">
            <div class="score-badge"></div>
            <div class="source-header">
                <h4 class="publication-name"></h4>
                <p class="source-meta"></p>
            </div>
            <div class="source-excerpt"></div>
            <div class="source-actions">
                <a href="#" class="source-link primary" target="_blank">View on
                    Lantern ‚Üí</a>
                <a href="#" class="source-link" target="_blank">Internet Archive
                    ‚Üí</a>
                <button class="btn-text fetch-full-text">Fetch Full
                    Text</button>
            </div>
        </div>
    </template>

    <script src="script.js"></script>
    <script src="../../shared/navigation.js"></script>

</body>

</html>